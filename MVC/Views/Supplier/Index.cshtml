@model List<MVC.Models.SupplierView>
@{
    ViewBag.Title = "Proveedores";
}
<html>
<head>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        let ascendingOrder = true;
        function Delete(id) {
            let aEliminar = confirm('Desea eliminar?');
            if (aEliminar) {
                $.ajax
                    (
                        {
                            type: "GET",
                            url: "/Supplier/Delete/" + id,
                            success: function (data) {
                                $("#supplier_" + id).remove();
                            },
                            error: function () {
                                alert("Ha ocurrido un error!!")
                            }
                        });
            }
        }
        function toggleSortOrder() {
            ascendingOrder = !ascendingOrder;
            let buttonText = ascendingOrder ? "Ordenar Por # Descendente" : "Ordenar Por # Ascendente";
            $("#sortById").text(buttonText); 
            let rows = $("#datos-container tbody tr").get();
            rows.sort(function (a, b) {
                let keyA = parseInt($(a).find("td:eq(0)").text());
                let keyB = parseInt($(b).find("td:eq(0)").text());
                if (ascendingOrder) {
                    return keyA - keyB; 
                } else {
                    return keyB - keyA; 
                }
            });

            $("#datos-container tbody").empty();
            $.each(rows, function (index, row) {
                $("#datos-container tbody").append(row);
            });
        }

        $(document).ready(function () {
            $("#sortById").click(toggleSortOrder);
        });
    </script>
</head>
<body>
    <br />
    <br />
    <br />
    <h2>@ViewBag.Title.</h2>
    <h3>@ViewBag.Message</h3>
    <div>
        <button id="sortById" class="btn btn-primary">Ordenar Por # Descendente</button>
        @Html.ActionLink("Insertar Nuevo Proveedor", "InsertUpdate", "", new { @class = "btn btn-success" })
    </div>
    <div id="datos-container">
        <table>
            <thead>
                <tr>
                    <th scope="col">#</th>
                    <th scope="col">Compañia</th>
                    <th scope="col">Contacto</th>
                    <th scope="col">Tiulo del Contacto</th>
                    <th scope="col">Direccion</th>
                    <th scope="col">Ciudad</th>
                    <th scope="col">Pais</th>
                    <th scope="col">Eliminar registro</th>
                    <th scope="col">Actualizar registro</th>

                </tr>
            </thead>
            <tbody>
                @foreach (var supplier in Model)
                {
                    <tr id="supplier_@supplier.Id">
                        <td scope="row">@supplier.Id</td>
                        <td scope="row">@supplier.CompanyName</td>
                        <td>@supplier.ContactName</td>
                        <td>@supplier.ContactTitle</td>
                        <td>@supplier.Address</td>
                        <td>@supplier.City</td>
                        <td>@supplier.Country</td>
                        <td><button onclick=Delete(@supplier.Id) class="btn btn-danger">Borrar</button></td>
                        <td>@Html.ActionLink("Actualizar", "InsertUpdate", new { id = supplier.Id, @class = "SupplierView" }, new { @class = "btn btn-info" })</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</body>
</html>
